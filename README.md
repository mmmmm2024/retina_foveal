# retina_foveal

2.2 モデルのコンパイル (Compilation)

NEURONの低レイヤーコード（.mod ファイル）をコンパイルします。
C言語の make に相当する重要な作業です。

nrnivmodl mod


[!IMPORTANT]
実行後、arm64/ または x86_64/ フォルダが生成されていれば成功です。
mod/ 内を書き換えた際は、必ず再実行（再コンパイル）してください。

2.3 動作確認 (Smoke Run)

最小構成でシミュレーションを実行し、環境が正常か確認します。

python init.py

3. プロジェクト構造 (Project Structure)

コードの役割を「回路の階層」として理解するためのマップです。

ディレクトリ/ファイル	役割 (Role)
cell/	モデル本体。細胞の形状や接続の定義。解析の核心部。
mod/	計算エンジン。NMODL形式で書かれたCコード群（チャネル・シナプス）。
src/	ユーティリティ。Python側のヘルパー関数やラッパー。
combine/	データ統合。複数条件の集計や、偏心度を跨ぐデータ処理用。
results/	出力先。シミュレーション結果（CSV, PNG等）が保存される。
*.hoc	NEURON独自の言語で書かれた細胞構築定義ファイル。
4. 実験の実行方法 (How to Run Experiments)

用途に合わせて以下のスクリプトを使い分けてください。

生存率スイープ

python sweep_survival.py


変性進行（細胞死）に伴う回路の変化をシミュレートします。

結合強度解析

python sweep_coupling.py


Gap Junctionなどの接続条件を振り、応答特性の変化を解析します。

可視化（ヒートマップ）

python aiiac_heatmap_rc_peripheral.py


解析結果を視覚的なマップとして出力し、傾向を把握します。

5. 設計哲学と10年後の後輩へ (Philosophy)

このシステムは、単一の「巨大な網膜」をシミュレートするものではありません。

なぜ一体化しないのか:
網膜の物理的な接続特性は偏心度（中心からの距離）によって劇的に変化します。
これらを一つの関数にまとめると、パラメータの混濁を招き、バグの温床となります。

拡張のルール:
新しい偏心度（例：5mm）を追加する場合は、既存の 1mm や 12mm の構成を「テンプレート」として複製・修正してください。
これにより、過去の実験との比較可能性（再現性）が担保されます。

6. トラブルシューティング (Troubleshooting)

ImportError: No module named 'neuron'
仮想環境が有効化されていますか？ source .venv/bin/activate を確認してください。

mechanism not found エラー
nrnivmodl mod を実行しましたか？ 実行ディレクトリがリポジトリルートであることを確認してください。

シミュレーション結果が更新されない
mod/ 内のCコードを修正しましたか？ 再コンパイルしない限り、変更は反映されません。
